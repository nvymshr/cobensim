{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "68dd5614-37e8-4b29-aa08-a9eb8872ef92",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ\n",
      "         LEHS EXECUTIVE DASHBOARD v2.2\n",
      "ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ\n"
     ]
    },
    {
     "ename": "TraitError",
     "evalue": "The 'children' trait of a VBox instance contains an Instance of a TypedTuple which expected a Widget, not the HTML <IPython.core.display.HTML object>.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTraitError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[4], line 174\u001b[0m\n\u001b[0;32m    171\u001b[0m calc_btn\u001b[38;5;241m.\u001b[39mon_click(generate_full_lehs)\n\u001b[0;32m    173\u001b[0m \u001b[38;5;66;03m# CLEAN DISPLAY - FIXED HTML\u001b[39;00m\n\u001b[1;32m--> 174\u001b[0m display(\u001b[43mwidgets\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mVBox\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\n\u001b[0;32m    175\u001b[0m \u001b[43m    \u001b[49m\u001b[43mHTML\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m<h2>ğŸ›ï¸ LEHS EXECUTIVE DASHBOARD</h2>\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    176\u001b[0m \u001b[43m    \u001b[49m\u001b[43mwidgets\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mHBox\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[43msector_w\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpractice_w\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    177\u001b[0m \u001b[43m    \u001b[49m\u001b[43mHTML\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m<h3>ğŸŒ States (Ctrl+click for multiple):</h3>\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    178\u001b[0m \u001b[43m    \u001b[49m\u001b[43mstates_w\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    179\u001b[0m \u001b[43m    \u001b[49m\u001b[43mHTML\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m<h3>ğŸ‘¨â€ğŸŒ¾ Custom Farms (ha/cows per farm):</h3>\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    180\u001b[0m \u001b[43m    \u001b[49m\u001b[43mwidgets\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mHBox\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[43msmall_ha_w\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43msmall_count_w\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    181\u001b[0m \u001b[43m    \u001b[49m\u001b[43mwidgets\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mHBox\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[43mmed_ha_w\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmed_count_w\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    182\u001b[0m \u001b[43m    \u001b[49m\u001b[43mwidgets\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mHBox\u001b[49m\u001b[43m(\u001b[49m\u001b[43m[\u001b[49m\u001b[43mlarge_ha_w\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlarge_count_w\u001b[49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    183\u001b[0m \u001b[43m    \u001b[49m\u001b[43mHTML\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m<h3>ğŸ“ˆ Emission Intensity:</h3>\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    184\u001b[0m \u001b[43m    \u001b[49m\u001b[43memission_w\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    185\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcalc_btn\u001b[49m\n\u001b[0;32m    186\u001b[0m \u001b[43m]\u001b[49m\u001b[43m)\u001b[49m)\n\u001b[0;32m    187\u001b[0m display(out)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\ipywidgets\\widgets\\widget_box.py:64\u001b[0m, in \u001b[0;36mBox.__init__\u001b[1;34m(self, children, **kwargs)\u001b[0m\n\u001b[0;32m     62\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m, children\u001b[38;5;241m=\u001b[39m(), \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs):\n\u001b[0;32m     63\u001b[0m     kwargs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mchildren\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m children\n\u001b[1;32m---> 64\u001b[0m     \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[38;5;21;43m__init__\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\ipywidgets\\widgets\\widget.py:503\u001b[0m, in \u001b[0;36mWidget.__init__\u001b[1;34m(self, **kwargs)\u001b[0m\n\u001b[0;32m    501\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Public constructor\"\"\"\u001b[39;00m\n\u001b[0;32m    502\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_model_id \u001b[38;5;241m=\u001b[39m kwargs\u001b[38;5;241m.\u001b[39mpop(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmodel_id\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[1;32m--> 503\u001b[0m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[38;5;21;43m__init__\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    505\u001b[0m Widget\u001b[38;5;241m.\u001b[39m_call_widget_constructed(\u001b[38;5;28mself\u001b[39m)\n\u001b[0;32m    506\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mopen()\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:1355\u001b[0m, in \u001b[0;36mHasTraits.__init__\u001b[1;34m(self, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1353\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m key, value \u001b[38;5;129;01min\u001b[39;00m kwargs\u001b[38;5;241m.\u001b[39mitems():\n\u001b[0;32m   1354\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mhas_trait(key):\n\u001b[1;32m-> 1355\u001b[0m         \u001b[38;5;28;43msetattr\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkey\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1356\u001b[0m         changes[key] \u001b[38;5;241m=\u001b[39m Bunch(\n\u001b[0;32m   1357\u001b[0m             name\u001b[38;5;241m=\u001b[39mkey,\n\u001b[0;32m   1358\u001b[0m             old\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1361\u001b[0m             \u001b[38;5;28mtype\u001b[39m\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mchange\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[0;32m   1362\u001b[0m         )\n\u001b[0;32m   1363\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m   1364\u001b[0m         \u001b[38;5;66;03m# passthrough args that don't set traits to super\u001b[39;00m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:716\u001b[0m, in \u001b[0;36mTraitType.__set__\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m    714\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mread_only:\n\u001b[0;32m    715\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m TraitError(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mThe \u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m trait is read-only.\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;241m%\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname)\n\u001b[1;32m--> 716\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:690\u001b[0m, in \u001b[0;36mTraitType.set\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m    689\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mset\u001b[39m(\u001b[38;5;28mself\u001b[39m, obj: HasTraits, value: S) \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m>\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m--> 690\u001b[0m     new_value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_validate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    691\u001b[0m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m    692\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:722\u001b[0m, in \u001b[0;36mTraitType._validate\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m    720\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m value\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mhasattr\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mvalidate\u001b[39m\u001b[38;5;124m\"\u001b[39m):\n\u001b[1;32m--> 722\u001b[0m     value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvalidate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    723\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj\u001b[38;5;241m.\u001b[39m_cross_validation_lock \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mFalse\u001b[39;00m:\n\u001b[0;32m    724\u001b[0m     value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_cross_validate(obj, value)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:3482\u001b[0m, in \u001b[0;36mContainer.validate\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m   3479\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m value \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m   3480\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m value\n\u001b[1;32m-> 3482\u001b[0m value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvalidate_elements\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3484\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m t\u001b[38;5;241m.\u001b[39mcast(T, value)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:3494\u001b[0m, in \u001b[0;36mContainer.validate_elements\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m   3492\u001b[0m     v \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_trait\u001b[38;5;241m.\u001b[39m_validate(obj, v)\n\u001b[0;32m   3493\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m TraitError \u001b[38;5;28;01mas\u001b[39;00m error:\n\u001b[1;32m-> 3494\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43merror\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43merror\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3495\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m   3496\u001b[0m     validated\u001b[38;5;241m.\u001b[39mappend(v)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:810\u001b[0m, in \u001b[0;36mTraitType.error\u001b[1;34m(self, obj, value, error, info)\u001b[0m\n\u001b[0;32m    801\u001b[0m         \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    802\u001b[0m             error\u001b[38;5;241m.\u001b[39margs \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    803\u001b[0m                 \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mThe \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m trait contains \u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m which \u001b[39m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mexpected \u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m, not \u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m.\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;241m.\u001b[39mformat(\n\u001b[0;32m    804\u001b[0m                     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    808\u001b[0m                 ),\n\u001b[0;32m    809\u001b[0m             )\n\u001b[1;32m--> 810\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m error\n\u001b[0;32m    812\u001b[0m \u001b[38;5;66;03m# this trait caused an error\u001b[39;00m\n\u001b[0;32m    813\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    814\u001b[0m     \u001b[38;5;66;03m# this is not the root trait\u001b[39;00m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:3492\u001b[0m, in \u001b[0;36mContainer.validate_elements\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m   3490\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m v \u001b[38;5;129;01min\u001b[39;00m value:\n\u001b[0;32m   3491\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3492\u001b[0m         v \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_trait\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_validate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3493\u001b[0m     \u001b[38;5;28;01mexcept\u001b[39;00m TraitError \u001b[38;5;28;01mas\u001b[39;00m error:\n\u001b[0;32m   3494\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39merror(obj, v, error)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:722\u001b[0m, in \u001b[0;36mTraitType._validate\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m    720\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m value\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mhasattr\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mvalidate\u001b[39m\u001b[38;5;124m\"\u001b[39m):\n\u001b[1;32m--> 722\u001b[0m     value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvalidate\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    723\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj\u001b[38;5;241m.\u001b[39m_cross_validation_lock \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mFalse\u001b[39;00m:\n\u001b[0;32m    724\u001b[0m     value \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_cross_validate(obj, value)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:2311\u001b[0m, in \u001b[0;36mInstance.validate\u001b[1;34m(self, obj, value)\u001b[0m\n\u001b[0;32m   2309\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m t\u001b[38;5;241m.\u001b[39mcast(T, value)\n\u001b[0;32m   2310\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 2311\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43merror\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalue\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\traitlets\\traitlets.py:815\u001b[0m, in \u001b[0;36mTraitType.error\u001b[1;34m(self, obj, value, error, info)\u001b[0m\n\u001b[0;32m    812\u001b[0m \u001b[38;5;66;03m# this trait caused an error\u001b[39;00m\n\u001b[0;32m    813\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    814\u001b[0m     \u001b[38;5;66;03m# this is not the root trait\u001b[39;00m\n\u001b[1;32m--> 815\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m TraitError(value, info \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39minfo(), \u001b[38;5;28mself\u001b[39m)\n\u001b[0;32m    817\u001b[0m \u001b[38;5;66;03m# this is the root trait\u001b[39;00m\n\u001b[0;32m    818\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m obj \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n",
      "\u001b[1;31mTraitError\u001b[0m: The 'children' trait of a VBox instance contains an Instance of a TypedTuple which expected a Widget, not the HTML <IPython.core.display.HTML object>."
     ]
    }
   ],
   "source": [
    "import ipywidgets as widgets\n",
    "from IPython.display import display, clear_output, HTML\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import plotly.graph_objects as go\n",
    "import plotly.express as px\n",
    "\n",
    "# ==============================================================================\n",
    "# ALL 28 STATES + FULL LEHS\n",
    "# ==============================================================================\n",
    "ALL_STATES = ['Andhra Pradesh', 'Arunachal Pradesh', 'Assam', 'Bihar', 'Chhattisgarh', \n",
    "              'Goa', 'Gujarat', 'Haryana', 'Himachal Pradesh', 'Jharkhand', \n",
    "              'Karnataka', 'Kerala', 'Madhya Pradesh', 'Maharashtra', 'Manipur',\n",
    "              'Meghalaya', 'Mizoram', 'Nagaland', 'Odisha', 'Punjab', \n",
    "              'Rajasthan', 'Sikkim', 'Tamil Nadu', 'Telangana', 'Tripura', \n",
    "              'Uttar Pradesh', 'Uttarakhand', 'West Bengal']\n",
    "\n",
    "STATE_DATA = {\n",
    "    'Punjab': {'rice_ch4': 5.5, 'dairy_ch4': 1.05, 'wage_mult': 1.40},\n",
    "    'Haryana': {'rice_ch4': 6.2, 'dairy_ch4': 1.10, 'wage_mult': 1.27},\n",
    "    'Gujarat': {'rice_ch4': 5.6, 'dairy_ch4': 1.04, 'wage_mult': 1.18},\n",
    "    'Uttar Pradesh': {'rice_ch4': 6.0, 'dairy_ch4': 1.15, 'wage_mult': 1.05},\n",
    "    'West Bengal': {'rice_ch4': 7.5, 'dairy_ch4': 1.25, 'wage_mult': 0.90},\n",
    "    'Bihar': {'rice_ch4': 6.8, 'dairy_ch4': 1.30, 'wage_mult': 0.78}\n",
    "}\n",
    "\n",
    "LEHS_CONFIGS = {\n",
    "    'Rice_AWD': {'CH4': 0.24, 'Water': 0.25, 'Income_ha': 8000, 'Labor_h_ha': 15, 'N_kg_ha': 2, 'DALY_tCO2e': 6.8},\n",
    "    'Rice_DSR': {'CH4': 0.30, 'Water': 0.23, 'Income_ha': 13789, 'Labor_h_ha': 115, 'N_kg_ha': 3, 'DALY_tCO2e': 6.8},\n",
    "    'Dairy_Feed': {'CH4': 0.18, 'Income_cow': 102188, 'Jobs_FTE_cow': 0.05, 'Pathogen_pct': 15, 'DALY_tCO2e': 6.8},\n",
    "    'Dairy_AS': {'CH4': 0.06, 'Income_cow': 1300, 'Jobs_FTE_cow': 0.03, 'Pathogen_pct': 10, 'DALY_tCO2e': 3.4}\n",
    "}\n",
    "\n",
    "print(\"ğŸŒŸ\"*40)\n",
    "print(\"         LEHS EXECUTIVE DASHBOARD v2.2\")\n",
    "print(\"ğŸŒŸ\"*40)\n",
    "\n",
    "# ==============================================================================\n",
    "# WIDGETS\n",
    "# ==============================================================================\n",
    "sector_w = widgets.Dropdown(options=['Rice', 'Dairy'], value='Dairy', description='Sector:')\n",
    "practice_w = widgets.Dropdown(options=list(LEHS_CONFIGS.keys()), value='Dairy_Feed', description='Practice:')\n",
    "states_w = widgets.SelectMultiple(options=ALL_STATES, value=['Uttar Pradesh'], rows=6, description='States:')\n",
    "\n",
    "small_ha_w = widgets.FloatText(value=1.2, description='Small ha/cows:')\n",
    "small_count_w = widgets.IntText(value=1000, description='#Small:')\n",
    "med_ha_w = widgets.FloatText(value=3.5, description='Med ha/cows:')\n",
    "med_count_w = widgets.IntText(value=500, description='#Med:')\n",
    "large_ha_w = widgets.FloatText(value=10.0, description='Large ha/cows:')\n",
    "large_count_w = widgets.IntText(value=100, description='#Large:')\n",
    "emission_w = widgets.FloatText(value=1.5, description='CH4 Intensity:')\n",
    "\n",
    "calc_btn = widgets.Button(description=\"ğŸ¯ GENERATE FULL LEHS\", button_style='success')\n",
    "out = widgets.Output()\n",
    "\n",
    "def generate_full_lehs(b):\n",
    "    with out:\n",
    "        clear_output(wait=True)\n",
    "        \n",
    "        sector = sector_w.value\n",
    "        practice = practice_w.value\n",
    "        selected_states = list(states_w.value)\n",
    "        emission = emission_w.value\n",
    "        \n",
    "        # CUSTOM FARMS\n",
    "        farms = {\n",
    "            'Small': {'ha_cows': small_ha_w.value, 'count': small_count_w.value},\n",
    "            'Medium': {'ha_cows': med_ha_w.value, 'count': med_count_w.value},\n",
    "            'Large': {'ha_cows': large_ha_w.value, 'count': large_count_w.value}\n",
    "        }\n",
    "        \n",
    "        total_ha = sum(f['ha_cows'] * f['count'] for f in farms.values()) if sector == 'Rice' else 0\n",
    "        total_cows = sum(f['ha_cows'] * f['count'] for f in farms.values()) if sector == 'Dairy' else 0\n",
    "        total_farms = sum(f['count'] for f in farms.values())\n",
    "        \n",
    "        coeff = LEHS_CONFIGS[practice]\n",
    "        adoption = 0.25\n",
    "        \n",
    "        # STATE-WISE LOOP\n",
    "        results = []\n",
    "        for state in selected_states:\n",
    "            state_data = STATE_DATA.get(state, {'rice_ch4': 6.0, 'dairy_ch4': 1.2, 'wage_mult': 1.0})\n",
    "            imputed = state not in STATE_DATA\n",
    "            \n",
    "            # BASELINE\n",
    "            if sector == 'Rice':\n",
    "                baseline_ch4 = emission * total_ha\n",
    "            else:\n",
    "                milk_l = total_cows * 9 * 365\n",
    "                baseline_ch4 = emission * milk_l\n",
    "            \n",
    "            ch4_reduc = baseline_ch4 * coeff['CH4'] * adoption * 0.028\n",
    "            \n",
    "            # LEHS CALCULATIONS\n",
    "            if sector == 'Rice':\n",
    "                income_cr = coeff['Income_ha'] * total_ha * adoption * state_data['wage_mult'] / 1e7\n",
    "                water_mkl = total_ha * 1.2 * coeff['Water'] * adoption\n",
    "                labor_kh = coeff['Labor_h_ha'] * total_ha * adoption / 1000\n",
    "                n_tonnes = coeff['N_kg_ha'] * total_ha * adoption / 1000\n",
    "                jobs_fte = total_ha * 0.0235  # IRRI data\n",
    "            else:\n",
    "                income_cr = coeff['Income_cow'] * total_cows * adoption * state_data['wage_mult'] / 1e7\n",
    "                jobs_fte = total_cows * coeff.get('Jobs_FTE_cow', 0.03)\n",
    "                water_mkl = labor_kh = n_tonnes = 0\n",
    "            \n",
    "            dalys = ch4_reduc * coeff['DALY_tCO2e']\n",
    "            \n",
    "            results.append({\n",
    "                'State': state, 'Imputed': 'âš ï¸' if imputed else 'âœ…',\n",
    "                'CH4_tCO2e': ch4_reduc, 'Income_Cr': income_cr, \n",
    "                'DALYs': dalys, 'Jobs_FTE': jobs_fte, \n",
    "                'Water_MkL': water_mkl, 'Labor_kh': labor_kh, 'N_tonnes': n_tonnes\n",
    "            })\n",
    "        \n",
    "        df_results = pd.DataFrame(results)\n",
    "        totals = df_results[['CH4_tCO2e', 'Income_Cr', 'DALYs', 'Jobs_FTE', 'Water_MkL', 'Labor_kh', 'N_tonnes']].sum()\n",
    "        \n",
    "        # EXECUTIVE SUMMARY\n",
    "        display(HTML(f\"\"\"\n",
    "        <div style=\"background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); \n",
    "                    color: white; padding: 25px; border-radius: 20px; margin: 20px 0; text-align: center;\">\n",
    "            <h1>ğŸš€ LEHS EXECUTIVE SUMMARY</h1>\n",
    "            <p><strong>{total_farms:,} farms</strong> | <strong>{len(selected_states)} states</strong> | \n",
    "            <strong>{sector} - {practice}</strong></p>\n",
    "        </div>\n",
    "        \"\"\"))\n",
    "        \n",
    "        # GRADIENT CARDS\n",
    "        cards_html = f\"\"\"\n",
    "        <div style=\"display: flex; gap: 20px; justify-content: center; margin: 20px 0; flex-wrap: wrap;\">\n",
    "            <div style=\"width: 180px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); \n",
    "                        color: white; border-radius: 15px; text-align: center; margin: 5px;\">\n",
    "                <h3>ğŸ’š CH4</h3><h1 style=\"font-size: 2.5em;\">{totals['CH4_tCO2e']:,.0f}</h1><p>tCOâ‚‚e</p>\n",
    "            </div>\n",
    "            <div style=\"width: 180px; padding: 20px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); \n",
    "                        color: white; border-radius: 15px; text-align: center; margin: 5px;\">\n",
    "                <h3>ğŸ’° Income</h3><h1 style=\"font-size: 2.5em;\">â‚¹{totals['Income_Cr']:.1f}</h1><p>Crore</p>\n",
    "            </div>\n",
    "            <div style=\"width: 180px; padding: 20px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); \n",
    "                        color: white; border-radius: 15px; text-align: center; margin: 5px;\">\n",
    "                <h3>â¤ï¸ Health</h3><h1 style=\"font-size: 2.5em;\">{totals['DALYs']:.0f}</h1><p>DALYs</p>\n",
    "            </div>\n",
    "            <div style=\"width: 180px; padding: 20px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); \n",
    "                        color: white; border-radius: 15px; text-align: center; margin: 5px;\">\n",
    "                <h3>ğŸ‘¥ Jobs</h3><h1 style=\"font-size: 2.5em;\">{totals['Jobs_FTE']:.0f}</h1><p>FTE</p>\n",
    "            </div>\n",
    "        </div>\n",
    "        \"\"\"\n",
    "        display(HTML(cards_html))\n",
    "        \n",
    "        # STATE TABLE\n",
    "        print(f\"\\nğŸ“Š STATE-WISE RESULTS ({len(selected_states)} states):\")\n",
    "        display(df_results[['State', 'Imputed', 'CH4_tCO2e', 'Income_Cr', 'DALYs', 'Jobs_FTE']]\n",
    "               .style.background_gradient(subset=['CH4_tCO2e', 'Income_Cr', 'Jobs_FTE'])\n",
    "               .format({'CH4_tCO2e': '{:.0f}', 'Income_Cr': 'â‚¹{:.1f}', 'DALYs': '{:.0f}', 'Jobs_FTE': '{:.0f}'}))\n",
    "        \n",
    "        if any(r['Imputed'] == 'âš ï¸' for r in results):\n",
    "            print(\"âš ï¸  *Some states use national averages (marked âš ï¸)*\")\n",
    "        \n",
    "        # FARM BREAKDOWN\n",
    "        farm_df = pd.DataFrame([{\n",
    "            'Size': k, 'User_ha_cows': v['ha_cows'], 'Farm_Count': v['count'],\n",
    "            'Total_ha_cows': v['ha_cows'] * v['count']\n",
    "        } for k, v in farms.items()])\n",
    "        \n",
    "        print(\"\\nğŸ‘¨â€ğŸŒ¾ YOUR FARM STRUCTURE:\")\n",
    "        display(farm_df.style.background_gradient().format({'Farm_Count': '{:,.0f}', 'Total_ha_cows': '{:.0f}'}))\n",
    "        \n",
    "        print(f\"\\nâœ… *BAHS 2023 | NDDB | GBD-MAPS | IRRI | {len(selected_states)} States*\")\n",
    "\n",
    "calc_btn.on_click(generate_full_lehs)\n",
    "\n",
    "# CLEAN DISPLAY - FIXED HTML\n",
    "display(widgets.VBox([\n",
    "    HTML(\"<h2>ğŸ›ï¸ LEHS EXECUTIVE DASHBOARD</h2>\"),\n",
    "    widgets.HBox([sector_w, practice_w]),\n",
    "    HTML(\"<h3>ğŸŒ States (Ctrl+click for multiple):</h3>\"),\n",
    "    states_w,\n",
    "    HTML(\"<h3>ğŸ‘¨â€ğŸŒ¾ Custom Farms (ha/cows per farm):</h3>\"),\n",
    "    widgets.HBox([small_ha_w, small_count_w]),\n",
    "    widgets.HBox([med_ha_w, med_count_w]),\n",
    "    widgets.HBox([large_ha_w, large_count_w]),\n",
    "    HTML(\"<h3>ğŸ“ˆ Emission Intensity:</h3>\"),\n",
    "    emission_w,\n",
    "    calc_btn\n",
    "]))\n",
    "display(out)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a63da71c-0ac9-4cf2-a009-548a154667a6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
